{"version":3,"sources":["OPTIONS.coffee"],"names":[],"mappings":"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","file":"OPTIONS.js","sourceRoot":"/source/","sourcesContent":["\n\n\n\n\n############################################################################################################\nnjs_path                  = require 'path'\nnjs_fs                    = require 'fs'\nnjs_os                    = require 'os'\n#...........................................................................................................\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'OPTIONS'\nlog                       = CND.get_logger 'plain',     badge\ninfo                      = CND.get_logger 'info',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\nalert                     = CND.get_logger 'alert',     badge\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\nhelp                      = CND.get_logger 'help',      badge\nurge                      = CND.get_logger 'urge',      badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\n# suspend                   = require 'coffeenode-suspend'\n# step                      = suspend.step\n# #...........................................................................................................\n# D                         = require 'pipedreams'\n# $                         = D.remit.bind D\n# $async                    = D.remit_async.bind D\n# #...........................................................................................................\n# ASYNC                     = require 'async'\n# #...........................................................................................................\n# Æ’                         = CND.format_number.bind CND\n# HELPERS                   = require './HELPERS'\n# TYPO                      = HELPERS[ 'TYPO' ]\n# options                   = require './options'\n# SEMVER                    = require 'semver'\nCS                        = require 'coffee-script'\n# options_route_fallback    = '../options.coffee'\n\n\n\n#===========================================================================================================\n# CACHE\n#-----------------------------------------------------------------------------------------------------------\n@CACHE = {}\n\n#-----------------------------------------------------------------------------------------------------------\n@CACHE.update = ( options ) ->\n  cache             = options[ 'cache' ][ '%self' ]\n  cache[ 'sysid' ]  = sysid = @_get_sysid()\n  unless cache[ sysid ]?\n    sys_cache         = {}\n    cache[ sysid ]    = sys_cache\n  @save options\n\n#-----------------------------------------------------------------------------------------------------------\n@CACHE.set = ( options, key, value, save = yes ) ->\n  target          = options[ 'cache' ][ '%self' ][ options[ 'cache' ][ '%self' ][ 'sysid' ] ]\n  target[ key ]  = value\n  @save options if save?\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@CACHE.get = ( options, key, method, save = yes, handler = null ) ->\n  cache   = options[ 'cache' ][ '%self' ]\n  sysid   = cache[ 'sysid' ]\n  target  = cache[  sysid  ]\n  R       = target[ key ]\n  if handler?\n    if R is undefined\n      method ( error, R ) =>\n        return handler error if error?\n        @set options, key, R, save\n        handler null, R\n    else\n      handler null, R\n  else\n    if R is undefined\n      @set options, key, ( R = method() ), save\n    return R\n\n#-----------------------------------------------------------------------------------------------------------\n@CACHE.save = ( options ) ->\n  locator = options[ 'cache' ][ 'locator' ]\n  cache   = options[ 'cache' ][ '%self' ]\n  njs_fs.writeFileSync locator, JSON.stringify cache, null, '  '\n\n#-----------------------------------------------------------------------------------------------------------\n@CACHE._get_sysid = -> \"#{njs_os.hostname()}:#{njs_os.platform()}\"\n\n\n#===========================================================================================================\n# OPTIONS\n#-----------------------------------------------------------------------------------------------------------\n@OPTIONS = {}\n\n#-----------------------------------------------------------------------------------------------------------\n@OPTIONS._require_coffee_file = ( route ) ->\n  extensions = Object.keys require[ 'extensions' ]\n  require 'coffee-script/register'\n  R = require route\n  for name in require[ 'extensions' ]\n    delete require[ 'extensions' ][ name ] unless name in extensions\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@OPTIONS._eval_coffee_file = ( route ) ->\n  rqr_route = require.resolve route\n  source    = njs_fs.readFileSync rqr_route, encoding: 'utf-8'\n  return CS.eval source, bare: true\n\n#-----------------------------------------------------------------------------------------------------------\n@OPTIONS.from_locator = ( options_locator ) ->\n  return @_require_coffee_file options_locator\n  # return @_eval_coffee_file options_locator\n\n\n\n\n"]}
{
  "version": 3,
  "file": "tex-writer-mkts-table.js",
  "sourceRoot": "..",
  "sources": [
    "src/tex-writer-mkts-table.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n\n'use strict'\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'MKTS/TEX-WRITER/MKTS-TABLE'\nlog                       = CND.get_logger 'plain',     badge\ninfo                      = CND.get_logger 'info',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\nalert                     = CND.get_logger 'alert',     badge\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\nhelp                      = CND.get_logger 'help',      badge\nurge                      = CND.get_logger 'urge',      badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\nD                         = require 'pipedreams'\n$                         = D.remit.bind D\n$async                    = D.remit_async.bind D\n#...........................................................................................................\nMKTS                      = require './main'\nMD_READER                 = require './md-reader'\nhide                      = MD_READER.hide.bind        MD_READER\ncopy                      = MD_READER.copy.bind        MD_READER\nstamp                     = MD_READER.stamp.bind       MD_READER\nunstamp                   = MD_READER.unstamp.bind     MD_READER\nselect                    = MD_READER.select.bind      MD_READER\nis_hidden                 = MD_READER.is_hidden.bind   MD_READER\nis_stamped                = MD_READER.is_stamped.bind  MD_READER\njr                        = JSON.stringify\n#...........................................................................................................\nMKTS_TABLE                = require './mkts-table'\nMKTS.MACRO_ESCAPER.register_raw_tag 'mkts-table-description'\nlayouts_sym               = Symbol 'mkts-table-layouts'\nselectors_and_content_events_sym = Symbol 'mkts-table-selectors_and_content_events'\n\n#===========================================================================================================\n#\n#-----------------------------------------------------------------------------------------------------------\n@$main = ( S ) ->\n  #.........................................................................................................\n  ### TAINT tie local state to events to avoid difficulties with non-synchronous / non-lockstepping\n  transforms ###\n  L = new_local_state S\n  return D.TEE.from_pipeline [\n    @$parse_description               S, L\n    @$handle_content_events           S, L\n    @$handle_fields                   S, L\n    # @$dump_table_layout               S, L\n    ]\n\n\n#===========================================================================================================\n#\n#-----------------------------------------------------------------------------------------------------------\nnew_local_state = ( S ) ->\n  ### TAINT using global variable FTTB ###\n  unless ( layouts = global[ layouts_sym ] )?\n    layouts               = {}\n    global[ layouts_sym ] = layouts\n  unless ( selectors_and_content_events = global[ selectors_and_content_events_sym ] )?\n    selectors_and_content_events               = {}\n    global[ selectors_and_content_events_sym ] = selectors_and_content_events\n  R =\n    selectors_and_content_events:   selectors_and_content_events\n    layouts:                        layouts\n    content_buffer:                 null\n    within_field:                   false\n    layout_name_stack:              []\n    ### TAINT we use this attribute to communicate the current selector from `$handle_fields()` back to\n    `$handle_content_events()`; this works b/c we're assuming that all event handling is happening in\n    lockstep. It might stop working as soon as the lockstepping is broken by an intervening asynchronous\n    or buffering stream transform. ###\n    ### TAINT used to store `layout_name` as well, already in `layout_name_stack` ###\n    field_selector_stack:           []\n  return R\n\n\n#-----------------------------------------------------------------------------------------------------------\n@is_within_table = ( S, L ) -> L.layout_name_stack.length > 0\n\n#-----------------------------------------------------------------------------------------------------------\n@get_current_layout_name = ( S, L ) ->\n  unless ( R = L.layout_name_stack[ L.layout_name_stack.length - 1 ] )?\n    throw new Error \"#{badge} µ1234 layout stack empty\"\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@get_current_field_selector = ( S, L ) ->\n  unless ( R = L.field_selector_stack[ L.field_selector_stack.length - 1 ] )?\n    throw new Error \"#{badge} µ1567 field_selector_stack stack empty\"\n  return R[ 1 ]\n\n#-----------------------------------------------------------------------------------------------------------\n@get_enclosing_layout_name = ( S, L ) ->\n  ### I've come to thoroughly dislike zero-based indexing paired with non-existing negative indexes.\n  We all should be writing `d[ 1 ]`, `d[ 2 ]` for the first and second elements from the left, and\n  `d[ -1 ]`, `d[ -2 ]` for the first and second elements from the right end of a list. ###\n  length    = L.layout_name_stack.length\n  last_idx  = L.layout_name_stack.length - 1\n  return null if length < 2\n  return L.layout_name_stack[ last_idx - 1 ]\n\n#-----------------------------------------------------------------------------------------------------------\n@pop_layout_name = ( S, L ) ->\n  R = @get_current_layout_name S, L\n  L.layout_name_stack.pop()\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@layout_from_name = ( S, L, layout_name ) ->\n  # debug '37733-1', ( Object.keys L.layouts ), ( L.layouts is global[ layouts_sym ] )\n  unless ( R = L.layouts[ layout_name ] )?\n    throw new Error \"#{badge} µ1900 unknown layout #{rpr layout_name}\"\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@push_layout_name = ( S, L, layout_name ) ->\n  # debug '37733-2', ( Object.keys L.layouts ), ( L.layouts is global[ layouts_sym ] )\n  unless L.layouts[ layout_name ]?\n    throw new Error \"#{badge} µ2233 unknown layout #{rpr layout_name}\"\n  L.layout_name_stack.push layout_name\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@store_layout = ( S, L, layout ) ->\n  if L.layouts[ layout.name ]?\n    throw new Error \"#{badge} µ2566 refusing to re-define layout #{rpr layout.name}\"\n  L.layouts[ layout.name ] = layout\n  # debug '37733-3', ( Object.keys L.layouts ), ( L.layouts is global[ layouts_sym ] )\n  @_initialize_layout S, L, layout.name\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@_API_copy = ( S, L, me, template_layout_name ) ->\n  ### TAINT ad-hoc syntax ###\n  unless ( match = template_layout_name.match /^\\s*(?<template_layout_name>[^\\s]+)\\s*$/ )?\n    throw new Error \"#{badge} µ2899 illegal layout name #{rpr template_layout_name}\"\n  { template_layout_name, } = match.groups\n  unless me.name != template_layout_name\n    throw new Error \"#{badge} µ3232 unable to copy layout #{rpr template_layout_name} to itself\"\n  template = CND.deep_copy @layout_from_name S, L, template_layout_name\n  delete template.name\n  Object.assign me, template\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@_initialize_layout = ( S, L, layout_name ) ->\n  L.selectors_and_content_events[ layout_name ] = []\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@new_content_buffer = ( S, L, layout_name, selector ) ->\n  unless ( target = L.selectors_and_content_events[ layout_name ] )?\n    throw new Error \"#{badge} µ3565 unknown layout #{rpr layout_name}\"\n  R = [ selector, ]\n  target.push R\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@push_field_selector = ( S, L, layout_name, selector ) ->\n  L.field_selector_stack.push [ layout_name, selector, ]\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@pop_field_selector = ( S, L ) ->\n  if L.field_selector_stack.length < 1\n    throw new Error \"#{badge} µ3898 field selector stack empty\"\n  return L.field_selector_stack.pop()\n\n#-----------------------------------------------------------------------------------------------------------\n@content_buffers_from_layout_name = ( S, L, layout_name ) ->\n  unless ( R = L.selectors_and_content_events[ layout_name ] )?\n    throw new Error \"#{badge} µ4231 unknown layout #{rpr layout_name}\"\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@clear_contents = ( S, L, layout_name ) ->\n  # debug '37733-4', ( Object.keys L.layouts ), ( L.layouts is global[ layouts_sym ] )\n  unless ( target = L.selectors_and_content_events[ layout_name ] )?\n    throw new Error \"#{badge} µ4564 unknown layout #{rpr layout_name}\"\n  target.length = 0\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@get_selectors_and_content_events = ( S, L, layout_name ) ->\n  # debug '37733-5', ( Object.keys L.layouts ), ( L.layouts is global[ layouts_sym ] )\n  unless ( R = L.selectors_and_content_events[ layout_name ] )?\n    # debug '88733', L.selectors_and_content_events\n    # debug '88733', Object.keys L.selectors_and_content_events\n    throw new Error \"#{badge} µ4897 unknown layout #{rpr layout_name}\"\n  return R\n\n#===========================================================================================================\n#\n#-----------------------------------------------------------------------------------------------------------\n@$dump_table_layout = ( S, L ) -> D.$observe ( event ) ->\n  return unless select event, '.', 'MKTS/TABLE/layout', true\n  help '99871', ( CND.blue rpr event[ 2 ] )\n\n#-----------------------------------------------------------------------------------------------------------\n@$parse_description = ( S, L ) ->\n  within_mkts_table = false\n  return $ ( event, send ) =>\n    #.......................................................................................................\n    ### TAINT change tag to sth like `mkts-table-layout` ###\n    if select event, '.', 'mkts-table-description'\n      [ type, name, Q, meta, ]    = event\n      ### TAINT other tags have attributes === Q, here attributes a property of Q ###\n      { text, attributes, }       = Q\n      attributes.format          ?= 'coffee'\n      send stamp event\n      switch attributes.format\n        when 'sqy'\n          READER  = require './mkts-table-layout-reader-sqy'\n          layout  = READER.read_layout S, L, event, text\n        when 'coffee'\n          READER  = require './mkts-table-layout-reader-coffee'\n          layout  = READER.read_layout S, L, event, text\n        else\n          throw new Error \"#{badge} µ5230 unknown format for <mkts-table-description>: #{rpr attributes.format}\"\n      send stamp [ '.', 'MKTS/TABLE/layout', layout, ( copy meta ), ]\n      layout.meta = copy meta\n      @store_layout S, L, layout\n    #.......................................................................................................\n    else\n      send event\n    #.......................................................................................................\n    return null\n\n#-----------------------------------------------------------------------------------------------------------\n@$handle_content_events = ( S, L ) ->\n  return $ ( event, send ) =>\n    #.......................................................................................................\n    ### When table contents start, we register that and do not send anything: ###\n    if select event, '(', 'mkts-table-content'\n      [ _, _, Q, _, ]       = event\n      ### OBS attribute is named 'layout' but contains layout name ###\n      unless Q.layout?\n        throw new Error \"#{badge} µ5563 missing required attribute `layout` for <mkts-table-content>: #{rpr event}\"\n      ### TAINT might want to add option to keep contents ###\n      @push_layout_name S, L, Q.layout\n      @clear_contents   S, L, Q.layout\n      send stamp event\n    #.......................................................................................................\n    ### When table contents end, we send all the sub-events needed to draw the table, and then the\n    description-end and description events: ###\n    else if select event, ')', 'mkts-table-content'\n      #.....................................................................................................\n      layout_name                   = @get_current_layout_name          S, L\n      layout                        = @layout_from_name                 S, L, layout_name\n      selectors_and_content_events  = @get_selectors_and_content_events S, L, layout_name\n      enclosing_layout_name         = @get_enclosing_layout_name        S, L\n      enclosing_layout              = null\n      # if enclosing_layout_name?\n      #   enclosing_layout              = @layout_from_name                 S, L, enclosing_layout_name\n      #   debug '38883', enclosing_layout\n      content_events                = MKTS_TABLE._walk_events layout, selectors_and_content_events, \\\n        L.layout_name_stack, L.field_selector_stack\n      #.....................................................................................................\n      if enclosing_layout_name?\n        current_field_selector    = @get_current_field_selector S, L\n        enclosing_content_events  = @content_buffers_from_layout_name S, L, enclosing_layout_name\n        enclosed_content_events   = [ current_field_selector, content_events..., ]\n        enclosing_content_events.push enclosed_content_events\n      #.....................................................................................................\n      else\n        send sub_event for sub_event from content_events\n      #.....................................................................................................\n      send stamp event\n      @pop_layout_name S, L\n    #.......................................................................................................\n    else\n      send event\n    return null\n\n#-----------------------------------------------------------------------------------------------------------\n@$handle_fields = ( S, L ) ->\n  content_buffer  = null\n  layout_name     = null\n  within_field    = false\n  return $ ( event, send ) =>\n    return send event unless @is_within_table S, L\n    # debug '43474', ( CND.truth @is_within_table S, L ), jr event\n    #.......................................................................................................\n    ### If we are within table contents, we collect all field events and their contents as table field\n    contents; outside that, whitespace events are ignored, and other material generates errors: ###\n    #.......................................................................................................\n    if select event, '(', 'field'\n      layout_name = @get_current_layout_name  S, L\n      ### TAINT should throw error when <field> nested within <field> *without* intervening <mkts-table-content> ###\n      # if within_field\n      #   throw new Error \"#{badge} µ5896 detected nested <field> tag (#{jr event}) in table #{rpr layout_name}\"\n      within_field              = true\n      [ type, name, Q, meta, ]  = event\n      unless Q? and Q.key?\n        throw new Error \"#{badge} µ6229 missing <field> tag attribute 'key' in table #{rpr layout_name} (#{jr event})\"\n      ### TAINT this is exactly the kind of dangerous 'could have happened anywhere, anytime' state mutation\n      that advocates of immutable state are warning us about: ###\n      @push_field_selector S, L, layout_name, Q.key\n      content_buffer            = @new_content_buffer S, L, layout_name,  Q.key\n      return send stamp event\n    #.......................................................................................................\n    if select event, ')', 'field'\n      within_field              = false\n      content_buffer            = null\n      @pop_field_selector S, L\n      return send stamp event\n    #.......................................................................................................\n    if within_field\n      # debug '37734', layout_name, jr event\n      content_buffer.push event\n      return null\n    #.......................................................................................................\n    ### Ignore whitespace between fields: ###\n    if ( select event, '.', 'text' ) and ( event[ 2 ].match /^\\s*$/ )?\n      # whisper '27762', jr event\n      return null\n    #.......................................................................................................\n    ### TAINT should be a fail, not an exception: ###\n    # throw new Error \"detected illegal content: #{jr event}\"\n    # warn '27762', ( within_field ), jr event\n    # return null\n    #.......................................................................................................\n    send event\n    return null\n"
  ]
}